(this.webpackChunkgriffeath_machine=this.webpackChunkgriffeath_machine||[]).push([[641],{4905:function(t,e,r){"use strict";r.d(e,{Z:function(){return b}});var n=r(7294),o=r(5697),i=r.n(o),a=r(3779),s=r.n(a);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=y(t);if(e){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(a,t);var e,r,o,i=h(a);function a(){var t;c(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return m(d(t=i.call.apply(i,[this].concat(r))),"canvasContext",void 0),m(d(t),"colorsOfField",void 0),m(d(t),"paint",(function(e){var r=t.props,n=r.width,o=r.height,i=r.states,a=n*o;t.colorsOfField=new Uint32Array(a);for(var u=0;u<a;u+=1){var c=s()(e[u],i),f=c.r,l=c.g,h=c.b;t.colorsOfField[u]=255<<24|h<<16|l<<8|f}var p=new ImageData(new Uint8ClampedArray(t.colorsOfField.buffer),n,o);t.canvasContext.putImageData(p,0,0)})),m(d(t),"refCanvas",(function(e){t.canvasContext=e&&e.getContext("2d",{desynchronized:!0})})),t}return e=a,(r=[{key:"render",value:function(){return n.createElement("canvas",{ref:this.refCanvas,width:this.props.width,height:this.props.height},"You are using an outdated browser without support of canvas elements.")}}])&&f(e.prototype,r),o&&f(e,o),a}(n.PureComponent);m(b,"propTypes",{width:i().number.isRequired,height:i().number.isRequired,states:i().number.isRequired})},5483:function(t,e,r){"use strict";function n(t){for(var e=t.width,r=t.height,n=t.states,o=e*r,i=new Uint8Array(o),a=0;a<o;a+=1)i[a]=Math.floor(Math.random()*n);return i}function o(t,e){return t<0?t+e:t>=e?t-e:t}function i(t,e,r,n,i,a,s){var u=n[t],c=o(u+1,s);return n[e+o(r-1,a)*i]===c||n[e+o(r+1,a)*i]===c||n[o(e-1,i)+r*i]===c||n[o(e+1,i)+r*i]===c?c:u}r.d(e,{BS:function(){return n},ds:function(){return a}});var a=function(t){for(var e=t.field,r=t.width,n=t.height,o=t.states,a=new Uint8Array(r*n),s=0;s<n;s+=1)for(var u=s*r,c=0;c<r;c+=1){var f=c+u;a[f]=i(f,c,s,e,r,n,o)}return a}},4688:function(t,e,r){"use strict";var n;function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{YD:function(){return i},TP:function(){return a},n$:function(){return s},gb:function(){return u}});var i={width:"width",height:"height",states:"states",status:"status"},a=(o(n={},i.width,1200),o(n,i.height,700),o(n,i.states,16),n),s={play:"Play",pause:"Pause"},u=32},6020:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return E}});var n=r(7294),o=r(5697),i=r.n(o),a=r(752),s=r(6319),u=r.n(s);function c(){return new Worker(r.p+"machine.worker.bundle.worker.js")}var f=r(4688),l=r(745),h=r(4905),p=r(5483);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=P(t);if(e){var o=P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g(this,r)}}function g(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}function k(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(s,t);var e,r,o,i=w(s);function s(){var t;m(this,s);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return k(O(t=i.call.apply(i,[this].concat(r))),"field",null),k(O(t),"canvas",n.createRef()),k(O(t),"frameTimes",[]),k(O(t),"workers",void 0),k(O(t),"state",{width:t.props.width,height:t.props.height,states:t.props.states,status:f.n$.pause,fps:0}),k(O(t),"updateFPS",(function(){for(var e=performance.now();t.frameTimes[0]<=e-1e3&&t.frameTimes.length>0;)t.frameTimes.shift();t.frameTimes.push(e),t.setState((function(){return{fps:t.frameTimes.length}}))})),k(O(t),"updateField",(function(e){t.field=e,t.canvas.current.paint(t.field),t.state.status===f.n$.play?(t.updateFPS(),t.handleNext()):t.setState({fps:0})})),k(O(t),"getActionName",(function(){return t.state.status===f.n$.play?f.n$.pause:f.n$.play})),k(O(t),"processKey",(function(e){e.keyCode===f.gb&&(e.preventDefault(),t.handlePlay())})),k(O(t),"updateFieldRandomly",(function(){t.updateField((0,p.BS)(t.state))})),k(O(t),"makeNewField",(function(){t.workers.terminate(),t.updateFieldRandomly()})),k(O(t),"handleNext",(function(){var e=t.state,r=e.width,n=e.height,o=e.states;t.workers.start({field:t.field,width:r,height:n,states:o},t.field.length)})),k(O(t),"handlePlay",(function(){switch(t.state.status){case f.n$.play:t.setState({status:f.n$.pause});break;case f.n$.pause:t.setState({status:f.n$.play},t.handleNext)}})),k(O(t),"changeHandler",(function(e,r){t.setState(k({},e,r))})),t}return e=s,(r=[{key:"componentDidMount",value:function(){this.workers=new(u())(c,this.updateField,{numberOfWorkers:4,ArrayConstructor:Uint8Array}),this.updateFieldRandomly(),this.handlePlay(),document.addEventListener("keydown",this.processKey)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.processKey),this.workers.terminate()}},{key:"render",value:function(){return n.createElement(n.Fragment,null,this.workers&&n.createElement("p",null,this.workers.threads," workers started"),n.createElement(a.wR,{state:this.state,onChange:this.changeHandler},n.createElement(a.II,{id:f.YD.width,label:"Field width",defaultNum:1}),n.createElement(a.II,{id:f.YD.height,label:"Field height",defaultNum:1}),n.createElement(a.II,{id:f.YD.states,label:"Number of states",defaultNum:1})),n.createElement("div",{onClick:this.handlePlay,onKeyDown:this.processKey,className:l.Z.field,role:"presentation",title:this.getActionName()},n.createElement(h.Z,{width:this.state.width,height:this.state.height,states:this.state.states,ref:this.canvas})),n.createElement("div",{className:l.Z.fps},this.state.fps," FPS",n.createElement("br",null),"in the canvas"),n.createElement("p",null,n.createElement("em",null,"Press Space or click field for play / pause")),n.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.makeNewField},"New"),n.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.handlePlay},this.getActionName()),this.state.status===f.n$.pause&&n.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.handleNext},"Next step"))}}])&&b(e.prototype,r),o&&b(e,o),s}(n.PureComponent);k(E,"propTypes",{width:i().number.isRequired,height:i().number.isRequired,states:i().number.isRequired}),k(E,"defaultProps",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},f.TP))},3779:function(t,e,r){const n=r(734),o={r:0,g:0,b:0},i=[];t.exports=function(t,e,r){if(!i[e]){i[e]=[];for(let t=0;t<=e;t+=1)i[e].push(n(t/e))}return i[e][t]||r||o}},6319:function(t){const e={handleError:console.error,numberOfWorkers:(globalThis.navigator||navigator).hardwareConcurrency||4,ArrayConstructor:Array};function r(t,r,{handleError:n=e.handleError,numberOfWorkers:o=e.numberOfWorkers,ArrayConstructor:i=e.ArrayConstructor}=e){let a,s,u=[];function c(){a=0,s=[]}this.threads=o;const f=()=>{let t,e=0;for(let t=0;t<this.threads;t++)e+=s[t].length;let n=0;if(i===Array)t=[].concat(...s);else{t=new i(e);for(let e=0;e<this.threads;e++){const r=s[e];t.set(r,n),n+=r.length}}r(t),c()},l=t=>({data:e})=>{s[t]=e,a+=1,a===this.threads&&f()};this.terminate=()=>(u.forEach((t=>{t.terminate()})),u=[],this);const h=t=>{this.terminate(),c(),n(t)},p=()=>{for(let e=0;e<this.threads;e++)u[e]=new t,u[e].addEventListener("message",l(e)),u[e].addEventListener("error",h)};this.start=(t,e)=>{let r=e%this.threads;const n=(e-r)/this.threads;c(),u.length||p();for(let e=0;e<this.threads;e++){const o=r+n;if(!u[e])break;u[e].postMessage({...t,from:0===e?0:r,to:o}),r=o}return this}}r.DEFAULTS=e,t.exports=r}}]);