(this.webpackChunkgriffeath_machine=this.webpackChunkgriffeath_machine||[]).push([[998],{130:function(e,t,r){"use strict";r.d(t,{A:function(){return h}});var s=r(540),n=r(556),i=r.n(n),a=r(176);function o(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h extends s.PureComponent{constructor(){super(...arguments),o(this,"canvasContext",void 0),o(this,"colorsOfField",void 0),o(this,"paint",(e=>{const{width:t,height:r,states:s,shuffle:n}=this.props,i=t*r;this.colorsOfField=new Uint32Array(i);for(let t=0;t<i;t+=1){const{r:r,g:i,b:o}=(0,a.w)(e[t],s,n);this.colorsOfField[t]=255<<24|o<<16|i<<8|r}const o=new ImageData(new Uint8ClampedArray(this.colorsOfField.buffer),t,r);this.canvasContext.putImageData(o,0,0)})),o(this,"refCanvas",(e=>{this.canvasContext=e&&e.getContext("2d",{desynchronized:!0})}))}render(){return s.createElement("canvas",{ref:this.refCanvas,width:this.props.width,height:this.props.height},"You are using an outdated browser without support of canvas elements.")}}o(h,"propTypes",{width:i().number.isRequired,height:i().number.isRequired,states:i().number.isRequired,shuffle:i().bool.isRequired})},270:function(e,t,r){"use strict";r.d(t,{A:function(){return l}});var s=r(540),n=r(556),i=r.n(n),a=r(195),o=r(563),h=r(431);function l(e){let{state:t,onChange:r,onReset:n,onPlayPause:i,onNextStep:l}=e;return(0,s.useEffect)((()=>{const e=e=>{switch(e.key){case o.Ry:e.preventDefault(),e.getModifierState(o.ZF)?l():i();break;case o.eu:e.preventDefault(),n()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]),s.createElement(s.Fragment,null,s.createElement(a.Wi,{state:t,onChange:r},s.createElement(a.pd,{id:o.Bq.width,label:"Field width",defaultNum:1}),s.createElement(a.pd,{id:o.Bq.height,label:"Field height",defaultNum:1}),s.createElement(a.pd,{id:o.Bq.states,label:"Number of states",defaultNum:1}),s.createElement(a.Jl,{id:o.Bq.shuffle,label:"Shuffle colors"})),s.createElement("p",null,s.createElement("span",{onClick:n,role:"button"},s.createElement("span",{className:h.A.key},"Enter"),s.createElement("span",{className:h.A.activeDescription},"New (Reset)"))),s.createElement("p",null,s.createElement("span",{onClick:i,role:"button"},s.createElement("span",{className:h.A.key},"Space"),s.createElement("span",{className:h.A.activeDescription},"Play / Pause"))),s.createElement("p",{className:t.status!==o.f.pause?h.A.hidden:void 0},s.createElement("span",{onClick:l,role:"button"},s.createElement("span",{className:h.A.key},"Shift")," + ",s.createElement("span",{className:h.A.key},"Space"),s.createElement("span",{className:h.A.activeDescription},"One step forward"))))}l.propTypes={state:i().exact({width:i().number.isRequired,height:i().number.isRequired,states:i().number.isRequired,shuffle:i().bool.isRequired,status:i().string.isRequired}).isRequired,onChange:i().func.isRequired,onReset:i().func.isRequired,onPlayPause:i().func.isRequired,onNextStep:i().func.isRequired}},775:function(e,t,r){"use strict";function s(e){let{width:t,height:r,states:s}=e;const n=t*r,i=new Uint8Array(n);for(let e=0;e<n;e+=1)i[e]=Math.floor(Math.random()*s);return i}function n(e,t){return e<0?e+t:e>=t?e-t:e}function i(e,t,r,s,i,a,o){const h=s[e],l=n(h+1,o);return s[t+n(r-1,a)*i]===l||s[t+n(r+1,a)*i]===l||s[n(t-1,i)+r*i]===l||s[n(t+1,i)+r*i]===l?l:h}r.d(t,{Qt:function(){return s},s2:function(){return a}});const a=e=>{let{field:t,width:r,height:s,states:n}=e;const a=new Uint8Array(r*s);for(let e=0;e<s;e+=1){const o=e*r;for(let h=0;h<r;h+=1){const l=h+o;a[l]=i(l,h,e,t,r,s,n)}}return a}},563:function(e,t,r){"use strict";r.d(t,{Bq:function(){return s},Ry:function(){return o},ZF:function(){return h},eu:function(){return a},f:function(){return n},qN:function(){return i}});const s={width:"width",height:"height",states:"states",shuffle:"shuffle"},n={play:"Play",pause:"Pause"},i={[s.width]:1200,[s.height]:700,[s.states]:18,[s.shuffle]:!1},a="Enter",o=" ",h="Shift"},944:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(540),n=r(163),i=r.n(n),a=r(563),o=r(775),h=r(130),l=r(270),u=r(431);function c(){return new Worker(r.p+"machine.worker.bundle.worker.js")}function f(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends s.PureComponent{constructor(){super(...arguments),f(this,"field",null),f(this,"canvas",s.createRef()),f(this,"frameTimes",[]),f(this,"workers",void 0),f(this,"state",{...a.qN,status:a.f.play,fps:0}),f(this,"updateFPS",(()=>{const e=performance.now();for(;this.frameTimes[0]<=e-1e3&&this.frameTimes.length>0;)this.frameTimes.shift();this.frameTimes.push(e),this.setState({fps:this.frameTimes.length})})),f(this,"updateField",(e=>{this.field=e,this.canvas.current.paint(this.field),this.state.status===a.f.play?(this.updateFPS(),this.handleNext()):this.setState({fps:0})})),f(this,"updateFieldRandomly",(()=>{this.updateField((0,o.Qt)(this.state))})),f(this,"makeNewField",(()=>{this.workers.terminate(),this.updateFieldRandomly()})),f(this,"handleNext",(()=>{const{width:e,height:t,states:r}=this.state;this.workers.start({field:this.field,width:e,height:t,states:r},this.field.length)})),f(this,"handlePlay",(()=>{switch(this.state.status){case a.f.play:this.setState({status:a.f.pause});break;case a.f.pause:this.setState({status:a.f.play},this.handleNext)}})),f(this,"changeHandler",((e,t)=>{this.setState({[e]:t})}))}componentDidMount(){this.workers=new(i())(c,this.updateField,{numberOfWorkers:4,ArrayConstructor:Uint8Array}),this.updateFieldRandomly()}componentWillUnmount(){this.workers.terminate()}render(){const{fps:e,...t}=this.state;return s.createElement(s.Fragment,null,this.workers&&s.createElement("p",null,this.workers.threads," workers started"),s.createElement(l.A,{state:t,onChange:this.changeHandler,onReset:this.makeNewField,onPlayPause:this.handlePlay,onNextStep:this.handleNext}),s.createElement("div",{onClick:this.handlePlay,className:u.A.field,role:"presentation",title:"⏯"},s.createElement(h.A,{width:this.state.width,height:this.state.height,states:this.state.states,shuffle:this.state.shuffle,ref:this.canvas})),s.createElement("div",{className:u.A.fps},e," FPS",s.createElement("br",null),"in the canvas"))}}},176:function(e,t,r){const{mapColor:s}=r(336),n={r:0,g:0,b:0},i=[],a=[];e.exports.w=(e,t,r=!1,o=n)=>{const h=r?a:i;if(!h[t]){h[t]=[];for(let e=0;e<t;e++)h[t].push(s(e/t));r&&(h[t]=function(e){const t=[...e];for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}(h[t]))}return h[t][e]||o}},163:function(e){const t={onError:()=>{},numberOfWorkers:(globalThis.navigator||navigator).hardwareConcurrency||4,ArrayConstructor:Array};function r(e,r,{onError:s=t.onError,numberOfWorkers:n=t.numberOfWorkers,ArrayConstructor:i=t.ArrayConstructor}=t){let a,o,h=[];this.threads=n,this.working=!1;const l=()=>{a=0,o=[]},u=()=>{let e,t=0;for(let e=0;e<this.threads;e++)t+=o[e].length;let s=0;if(i===Array)e=[].concat(...o);else{e=new i(t);for(let t=0;t<this.threads;t++){const r=o[t];e.set(r,s),s+=r.length}}r(e),l()};this.terminate=()=>(h.forEach((e=>{e.terminate()})),h=[],this.working=!1,this);const c=e=>({data:t})=>{o[e]=t,a+=1,a===this.threads&&(this.working=!1,u())},f=e=>{this.terminate(),l(),s(e)},d=()=>{for(let t=0;t<this.threads;t++)h[t]=new e,h[t].addEventListener("message",c(t)),h[t].addEventListener("error",f)};this.start=(e,t)=>{if(this.working)return s("Workers have already started!"),this;this.working=!0;let r=t%this.threads;const n=(t-r)/this.threads;l(),h.length||d();for(let t=0;t<this.threads;t++){const s=r+n;if(!h[t])break;h[t].postMessage({...e,from:0===t?0:r,to:s}),r=s}return this}}r.DEFAULTS=t,e.exports=r}}]);