(this.webpackChunkgriffeath_machine=this.webpackChunkgriffeath_machine||[]).push([[998],{130:function(e,t,s){"use strict";s.d(t,{A:function(){return h}});var n=s(540),r=s(556),a=s.n(r),i=s(176);function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class h extends n.PureComponent{constructor(){super(...arguments),o(this,"canvasContext",void 0),o(this,"colorsOfField",void 0),o(this,"paint",(e=>{const{width:t,height:s,states:n,shuffle:r}=this.props,a=t*s;this.colorsOfField=new Uint32Array(a);for(let t=0;t<a;t+=1){const{r:s,g:a,b:o}=(0,i.w)(e[t],n,r);this.colorsOfField[t]=255<<24|o<<16|a<<8|s}const o=new ImageData(new Uint8ClampedArray(this.colorsOfField.buffer),t,s);this.canvasContext.putImageData(o,0,0)})),o(this,"refCanvas",(e=>{this.canvasContext=e&&e.getContext("2d",{desynchronized:!0})}))}render(){return n.createElement("canvas",{ref:this.refCanvas,width:this.props.width,height:this.props.height},"You are using an outdated browser without support of canvas elements.")}}o(h,"propTypes",{width:a().number.isRequired,height:a().number.isRequired,states:a().number.isRequired,shuffle:a().bool.isRequired})},270:function(e,t,s){"use strict";s.d(t,{A:function(){return l}});var n=s(540),r=s(556),a=s.n(r),i=s(195),o=s(563),h=s(431);function l(e){let{state:t,onChange:s,onReset:r,onPlayPause:a,onNextStep:l}=e;return(0,n.useEffect)((()=>{const e=e=>{switch(e.key){case o.Ry:e.preventDefault(),e.getModifierState(o.ZF)?l():a();break;case o.eu:e.preventDefault(),r()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]),n.createElement(n.Fragment,null,n.createElement(i.Wi,{state:t,onChange:s},n.createElement(i.pd,{id:o.Bq.width,label:"Field width",defaultNum:1}),n.createElement(i.pd,{id:o.Bq.height,label:"Field height",defaultNum:1}),n.createElement(i.pd,{id:o.Bq.states,label:"Number of states",defaultNum:1}),n.createElement(i.Jl,{id:o.Bq.shuffle,label:"Shuffle colors"})),n.createElement("p",null,n.createElement("span",{onClick:r,role:"button"},n.createElement("span",{className:h.A.key},"Enter"),n.createElement("span",{className:h.A.activeDescription},"New (Reset)"))),n.createElement("p",null,n.createElement("span",{onClick:a,role:"button"},n.createElement("span",{className:h.A.key},"Space"),n.createElement("span",{className:h.A.activeDescription},"Play / Pause"))),n.createElement("p",{className:t.status!==o.f.pause?h.A.hidden:void 0},n.createElement("span",{onClick:l,role:"button"},n.createElement("span",{className:h.A.key},"Shift")," + ",n.createElement("span",{className:h.A.key},"Space"),n.createElement("span",{className:h.A.activeDescription},"One step forward"))))}l.propTypes={state:a().exact({width:a().number.isRequired,height:a().number.isRequired,states:a().number.isRequired,shuffle:a().bool.isRequired,status:a().string.isRequired}).isRequired,onChange:a().func.isRequired,onReset:a().func.isRequired,onPlayPause:a().func.isRequired,onNextStep:a().func.isRequired}},775:function(e,t,s){"use strict";function n(e){let{width:t,height:s,states:n}=e;const r=t*s,a=new Uint8Array(r);for(let e=0;e<r;e+=1)a[e]=Math.floor(Math.random()*n);return a}function r(e,t){return e<0?e+t:e>=t?e-t:e}function a(e,t,s,n,a,i,o){const h=n[e],l=r(h+1,o);return n[t+r(s-1,i)*a]===l||n[t+r(s+1,i)*a]===l||n[r(t-1,a)+s*a]===l||n[r(t+1,a)+s*a]===l?l:h}s.d(t,{Qt:function(){return n},s2:function(){return i}});const i=e=>{let{field:t,width:s,height:n,states:r}=e;const i=new Uint8Array(s*n);for(let e=0;e<n;e+=1){const o=e*s;for(let h=0;h<s;h+=1){const l=h+o;i[l]=a(l,h,e,t,s,n,r)}}return i}},563:function(e,t,s){"use strict";s.d(t,{Bq:function(){return n},Ry:function(){return o},ZF:function(){return h},eu:function(){return i},f:function(){return r},qN:function(){return a}});const n={width:"width",height:"height",states:"states",shuffle:"shuffle"},r={play:"Play",pause:"Pause"},a={[n.width]:1200,[n.height]:700,[n.states]:18,[n.shuffle]:!1},i="Enter",o=" ",h="Shift"},944:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var n=s(540),r=s(163),a=s.n(r),i=s(563),o=s(775),h=s(130),l=s(270),u=s(431);function c(){return new Worker(s.p+"machine.worker.bundle.worker.js")}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class f extends n.PureComponent{constructor(){super(...arguments),d(this,"field",null),d(this,"canvas",n.createRef()),d(this,"frameTimes",[]),d(this,"workers",void 0),d(this,"state",{...i.qN,status:i.f.play,fps:0}),d(this,"updateFPS",(()=>{const e=performance.now();for(;this.frameTimes[0]<=e-1e3&&this.frameTimes.length>0;)this.frameTimes.shift();this.frameTimes.push(e),this.setState({fps:this.frameTimes.length})})),d(this,"updateField",(e=>{this.field=e,this.canvas.current.paint(this.field),this.state.status===i.f.play?(this.updateFPS(),this.handleNext()):this.setState({fps:0})})),d(this,"updateFieldRandomly",(()=>{this.updateField((0,o.Qt)(this.state))})),d(this,"makeNewField",(()=>{this.workers.terminate(),this.updateFieldRandomly()})),d(this,"handleNext",(()=>{const{width:e,height:t,states:s}=this.state;this.workers.start({field:this.field,width:e,height:t,states:s},this.field.length)})),d(this,"handlePlay",(()=>{switch(this.state.status){case i.f.play:this.setState({status:i.f.pause});break;case i.f.pause:this.setState({status:i.f.play},this.handleNext)}})),d(this,"changeHandler",((e,t)=>{this.setState({[e]:t})}))}componentDidMount(){this.workers=new(a())(c,this.updateField,{numberOfWorkers:4,ArrayConstructor:Uint8Array}),this.updateFieldRandomly()}componentWillUnmount(){this.workers.terminate()}render(){const{fps:e,...t}=this.state;return n.createElement(n.Fragment,null,this.workers&&n.createElement("p",null,this.workers.threads," workers started"),n.createElement(l.A,{state:t,onChange:this.changeHandler,onReset:this.makeNewField,onPlayPause:this.handlePlay,onNextStep:this.handleNext}),n.createElement("div",{onClick:this.handlePlay,className:u.A.field,role:"presentation",title:"⏯"},n.createElement(h.A,{width:this.state.width,height:this.state.height,states:this.state.states,shuffle:this.state.shuffle,ref:this.canvas})),n.createElement("div",{className:u.A.fps},e," FPS",n.createElement("br",null),"in the canvas"))}}},176:function(e,t,s){const{mapColor:n}=s(336),r={r:0,g:0,b:0},a=[],i=[];e.exports.w=(e,t,s=!1,o=r)=>{const h=s?i:a;if(!h[t]){h[t]=[];for(let e=0;e<t;e++)h[t].push(n(e/t));s&&(h[t]=function(e){const t=[...e];for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t}(h[t]))}return h[t][e]||o}},163:function(e){const t={onError:()=>{},numberOfWorkers:(globalThis.navigator||navigator).hardwareConcurrency||4,ArrayConstructor:Array};function s(e,s,{onError:n=t.onError,numberOfWorkers:r=t.numberOfWorkers,ArrayConstructor:a=t.ArrayConstructor}=t){let i,o,h=[];this.threads=r,this.working=!1;const l=()=>{i=0,o=[]},u=()=>{let e,t=0;for(let e=0;e<this.threads;e++)t+=o[e].length;let n=0;if(a===Array)e=[].concat(...o);else{e=new a(t);for(let t=0;t<this.threads;t++){const s=o[t];e.set(s,n),n+=s.length}}s(e),l()};this.terminate=()=>(h.forEach((e=>{e.terminate()})),h=[],this.working=!1,this);const c=e=>({data:t})=>{o[e]=t,i+=1,i===this.threads&&(this.working=!1,u())},d=e=>{this.terminate(),l(),n(e)},f=()=>{for(let t=0;t<this.threads;t++)h[t]=new e,h[t].addEventListener("message",c(t)),h[t].addEventListener("error",d)};this.start=(e,t)=>{if(this.working)return n("Workers have already started!"),this;this.working=!0;let s=t%this.threads;const r=(t-s)/this.threads;l(),h.length||f();for(let t=0;t<this.threads;t++){const n=s+r;if(!h[t])break;h[t].postMessage({...e,from:0===t?0:s,to:n}),s=n}return this}}s.DEFAULTS=t,e.exports=s}}]);