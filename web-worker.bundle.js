(this.webpackChunkgriffeath_machine=this.webpackChunkgriffeath_machine||[]).push([[641],{4905:function(t,e,n){"use strict";n.d(e,{Z:function(){return b}});var r=n(7294),o=n(5697),a=n.n(o),i=n(3779),s=n.n(i);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(i,t);var e,n,o,a=h(i);function i(){var t;c(this,i);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(d(t=a.call.apply(a,[this].concat(n))),"canvasContext",void 0),m(d(t),"colorsOfField",void 0),m(d(t),"paint",(function(e){var n=t.props,r=n.width,o=n.height,a=n.states,i=r*o;t.colorsOfField=new Uint32Array(i);for(var u=0;u<i;u+=1){var c=s()(e[u],a),f=c.r,l=c.g,h=c.b;t.colorsOfField[u]=255<<24|h<<16|l<<8|f}var p=new ImageData(new Uint8ClampedArray(t.colorsOfField.buffer),r,o);t.canvasContext.putImageData(p,0,0)})),m(d(t),"refCanvas",(function(e){t.canvasContext=e&&e.getContext("2d",{desynchronized:!0})})),t}return e=i,(n=[{key:"render",value:function(){return r.createElement("canvas",{ref:this.refCanvas,width:this.props.width,height:this.props.height},"You are using an outdated browser without support of canvas elements.")}}])&&f(e.prototype,n),o&&f(e,o),i}(r.PureComponent);m(b,"propTypes",{width:a().number.isRequired,height:a().number.isRequired,states:a().number.isRequired})},5483:function(t,e,n){"use strict";function r(t){for(var e=t.width,n=t.height,r=t.states,o=e*n,a=new Uint8Array(o),i=0;i<o;i+=1)a[i]=Math.floor(Math.random()*r);return a}function o(t,e){return t<0?t+e:t>=e?t-e:t}function a(t,e,n,r,a,i,s){var u=r[t],c=o(u+1,s);return r[e+o(n-1,i)*a]===c||r[e+o(n+1,i)*a]===c||r[o(e-1,a)+n*a]===c||r[o(e+1,a)+n*a]===c?c:u}n.d(e,{BS:function(){return r},ds:function(){return i}});var i=function(t){for(var e=t.field,n=t.width,r=t.height,o=t.states,i=new Uint8Array(n*r),s=0;s<r;s+=1)for(var u=s*n,c=0;c<n;c+=1){var f=c+u;i[f]=a(f,c,s,e,n,r,o)}return i}},4688:function(t,e,n){"use strict";var r;function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{YD:function(){return a},TP:function(){return i},n$:function(){return s},gb:function(){return u}});var a={width:"width",height:"height",states:"states",status:"status"},i=(o(r={},a.width,1200),o(r,a.height,700),o(r,a.states,16),r),s={play:"Play",pause:"Pause"},u=32},6020:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return E}});var r=n(7294),o=n(5697),a=n.n(o),i=n(5708),s=n(6319),u=n.n(s);function c(){return new Worker(n.p+"machine.worker.bundle.worker.js")}var f=n(4688),l=n(745),h=n(4905),p=n(5483);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=P(t);if(e){var o=P(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?O(t):e}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(s,t);var e,n,o,a=v(s);function s(){var t;m(this,s);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return k(O(t=a.call.apply(a,[this].concat(n))),"field",null),k(O(t),"canvas",r.createRef()),k(O(t),"frameTimes",[]),k(O(t),"workers",void 0),k(O(t),"state",{width:t.props.width,height:t.props.height,states:t.props.states,status:f.n$.pause,fps:0}),k(O(t),"updateFPS",(function(){for(var e=performance.now();t.frameTimes[0]<=e-1e3&&t.frameTimes.length>0;)t.frameTimes.shift();t.frameTimes.push(e),t.setState((function(){return{fps:t.frameTimes.length}}))})),k(O(t),"updateField",(function(e){t.field=e,t.canvas.current.paint(t.field),t.state.status===f.n$.play?(t.updateFPS(),t.handleNext()):t.setState({fps:0})})),k(O(t),"handleError",(function(){t.setState({status:f.n$.pause},t.makeNewField)})),k(O(t),"getActionName",(function(){return t.state.status===f.n$.play?f.n$.pause:f.n$.play})),k(O(t),"processKey",(function(e){e.keyCode===f.gb&&(e.preventDefault(),t.handlePlay())})),k(O(t),"updateFieldRandomly",(function(){t.updateField((0,p.BS)(t.state))})),k(O(t),"makeNewField",(function(){t.workers.terminate(),t.updateFieldRandomly()})),k(O(t),"handleNext",(function(){var e=t.state,n=e.width,r=e.height,o=e.states;t.workers.start({field:t.field,width:n,height:r,states:o},t.field.length)})),k(O(t),"handlePlay",(function(){switch(t.state.status){case f.n$.play:t.setState({status:f.n$.pause});break;case f.n$.pause:t.setState({status:f.n$.play},t.handleNext)}})),k(O(t),"changeHandler",(function(e,n){t.setState(k({},e,n))})),t}return e=s,(n=[{key:"componentDidMount",value:function(){this.workers=new(u())(c,this.updateField,{handleError:this.handleError,ArrayConstructor:Uint8Array}),this.updateFieldRandomly(),this.handlePlay(),document.addEventListener("keydown",this.processKey)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.processKey),this.workers.terminate()}},{key:"render",value:function(){return r.createElement(r.Fragment,null,this.workers&&r.createElement("p",null,this.workers.threads," workers started"),r.createElement(i.wR,{state:this.state,onChange:this.changeHandler},r.createElement(i.II,{id:f.YD.width,label:"Field width",defaultNum:1}),r.createElement(i.II,{id:f.YD.height,label:"Field height",defaultNum:1}),r.createElement(i.II,{id:f.YD.states,label:"Number of states",defaultNum:1})),r.createElement("div",{onClick:this.handlePlay,onKeyDown:this.processKey,className:l.Z.field,role:"presentation",title:this.getActionName()},r.createElement(h.Z,{width:this.state.width,height:this.state.height,states:this.state.states,ref:this.canvas})),r.createElement("div",{className:l.Z.fps},this.state.fps," FPS",r.createElement("br",null),"in the canvas"),r.createElement("p",null,r.createElement("em",null,"Press Space or click field for play / pause")),r.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.makeNewField},"New"),r.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.handlePlay},this.getActionName()),this.state.status===f.n$.pause&&r.createElement("button",{type:"button",className:l.Z.bigButton,onClick:this.handleNext},"Next step"))}}])&&b(e.prototype,n),o&&b(e,o),s}(r.PureComponent);k(E,"propTypes",{width:a().number.isRequired,height:a().number.isRequired,states:a().number.isRequired}),k(E,"defaultProps",function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){k(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},f.TP))},3779:function(t,e,n){const r=n(734),o={r:0,g:0,b:0},a=[];t.exports=function(t,e,n){if(!a[e]){a[e]=[];for(let t=0;t<=e;t+=1)a[e].push(r(t/e))}return a[e][t]||n||o}},6319:function(t){const e={handleError:console.error,numberOfWorkers:navigator.hardwareConcurrency,ArrayConstructor:Array};t.exports=function(t,n,{handleError:r=e.handleError,numberOfWorkers:o=e.numberOfWorkers,ArrayConstructor:a=e.ArrayConstructor}=e){let i,s,u=[];function c(){i=0,s=[]}this.threads=o;const f=()=>{let t=0;for(let e=0;e<this.threads;e++)t+=s[e].length;let e=0,r=a===Array?[]:new a(t);for(let t=0;t<this.threads;t++)r.concat?r=r.concat(s[t]):r.set(s[t],e),e+=s[t].length;n(r),c()},l=t=>({data:e})=>{s[t]=e,i+=1,i===this.threads&&f()};this.terminate=()=>(u.forEach((t=>{t.terminate()})),u=[],this);const h=t=>{this.terminate(),c(),r(t)},p=()=>{for(let e=0;e<this.threads;e++)u[e]=new t,u[e].addEventListener("message",l(e)),u[e].addEventListener("error",h)};this.start=(t,e)=>{let n=e%this.threads;const r=(e-n)/this.threads;c(),u.length||p();for(let e=0;e<this.threads;e++){const o=n+r;u[e].postMessage({...t,from:0===e?0:n,to:o}),n=o}return this}}}}]);