{"version":3,"sources":["webpack:///./src/components/GriffeathMachine.css?c774","webpack:///./src/components/ErrorBoundary.jsx","webpack:///./src/utils.js","webpack:///./src/components/constants.js","webpack:///./src/components/CanvasField.jsx","webpack:///./src/components/GriffeathMachine.jsx","webpack:///./src/components/App.jsx","webpack:///./src/index.js"],"names":["module","exports","field","bigButton","react_default","a","createElement","onClick","window","location","reload","type","ErrorBoundary","props","_classCallCheck","this","_this","_possibleConstructorReturn","_React$Component","call","state","hasError","componentDidCatch","setState","render","_ref","_ref2","children","React","Component","getRandomField","width","height","states","x","y","Math","floor","random","mod","number","limit","getUpdatedField","map","line","element","plusOne","mapNumToRGB","h","h2rgb","initT","t","r","g","b","round","colorMapping","DEFAULT_COLOR","IDS","DEFAULT","_DEFAULT","STATUSES","play","pause","SPACE_CODE","CanvasField","drawPixel","index","_getColor","length","i","getColor","data","canvasData","paint","arguments","undefined","_this$props","canvasContext","getImageData","putImageData","refCanvas","elem","getContext","fillStyle","fillRect","componentDidMount","componentDidUpdate","ref","PureComponent","href","title","GriffeathMachine","status","canvas","createRef","getActionName","randomizeField","processKey","e","keyCode","preventDefault","handlePlay","nextStep","current","requestAnimationFrame","handleNew","handleNext","changeHandler","name","value","_this$setState","selectAll","control","setSelectionRange","componentWillMount","document","addEventListener","es","onChange","onFocus","id","label","defaultNum","onKeyDown","className","style","role","CanvasField_CanvasField","GriffeathMachine_ref","GriffeathMachine_ref2","defaultProps","GriffeathMachine_GriffeathMachine","App_ref","querySelector","stats","Stats","body","appendChild","dom","loop","update"],"mappings":"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","file":"app.0e840bcb.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"field\":\"GriffeathMachine__field__rXP46\",\"bigButton\":\"GriffeathMachine__bigButton__1sICS\"};","import React from 'react'\nimport PropTypes from 'prop-types'\n\nfunction reloadPage () {\n  window.location.reload()\n}\n\nexport default class ErrorBoundary extends React.Component {\n  static propTypes = {\n    children: PropTypes.element.isRequired,\n  }\n\n  constructor (props) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  componentDidCatch () {\n    this.setState({ hasError: true })\n  }\n\n  render () {\n    if (this.state.hasError) {\n      return [\n        <h1>{'I\\'m sorry. Something went wrong.'}</h1>,\n        <button onClick={reloadPage} type=\"button\">Reload</button>,\n      ]\n    }\n    return this.props.children\n  }\n}\n","export function getRandomField ({ width, height, states }) {\n  const field = []\n\n  for (let x = 0; x < width; x += 1) {\n    field[x] = []\n    for (let y = 0; y < height; y += 1) {\n      field[x][y] = Math.floor(Math.random() * states)\n    }\n  }\n\n  return field\n}\n\nconst mod = (number, limit) => (number < 0 ? number + limit : number % limit)\n\nexport const getUpdatedField = ({ field, width, height, states }) => field.map((line, x) => line.map((element, y) => {\n  const plusOne = mod(element + 1, states)\n\n  if (field[x][mod(y - 1, height)] === plusOne\n    || field[x][mod(y + 1, height)] === plusOne\n    || field[mod(x - 1, width)][y] === plusOne\n    || field[mod(x + 1, width)][y] === plusOne) {\n    return plusOne\n  }\n\n  return element\n}))\n\nexport function mapNumToRGB (h) {\n  const h2rgb = (initT) => {\n    const t = initT < 0 ? initT + 1 : initT % 1\n\n    if (t < 1 / 6) {\n      return 6 * t\n    }\n    if (t < 1 / 2) {\n      return 1\n    }\n    if (t < 2 / 3) {\n      return ((2 / 3) - t) * 6\n    }\n\n    return 0\n  }\n\n  const r = h2rgb(h + (1 / 3))\n  const g = h2rgb(h)\n  const b = h2rgb(h - (1 / 3))\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255),\n  }\n}\n\nconst colorMapping = []\nconst DEFAULT_COLOR = { r: 0, g: 0, b: 0 }\n\nexport function getColor (h, states) {\n  if (colorMapping.length !== states) {\n    colorMapping.length = states\n    for (let i = 0; i < states; i += 1) {\n      colorMapping[i] = mapNumToRGB(i / states)\n    }\n  }\n  return colorMapping[h] || DEFAULT_COLOR\n}\n","export const IDS = {\n  width: 'width',\n  height: 'height',\n  states: 'states',\n  status: 'status',\n}\n\nexport const DEFAULT = {\n  [IDS.width]: 500,\n  [IDS.height]: 500,\n  [IDS.states]: 16,\n}\n\nexport const STATUSES = {\n  play: 'Play',\n  pause: 'Pause',\n}\n\nexport const SPACE_CODE = 32\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { getColor } from '../utils'\n\nexport default class CanvasField extends React.PureComponent {\n  static propTypes = {\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    field: PropTypes.arrayOf(PropTypes.array).isRequired,\n    states: PropTypes.number.isRequired,\n  }\n\n  componentDidMount () {\n    this.paint()\n  }\n\n  componentDidUpdate () {\n    this.paint()\n  }\n\n  drawPixel = (x, y, h, states) => {\n    const index = (x + (y * this.props.width)) * 4\n    const { r, g, b } = getColor(h, states)\n    const { data } = this.canvasData\n\n    data[index] = r\n    data[index + 1] = g\n    data[index + 2] = b\n  }\n\n  paint = (field = this.props.field) => {\n    const { width, height, states } = this.props\n\n    this.canvasData = this.canvasContext.getImageData(0, 0, width, height)\n\n    for (let x = 0; x < width; x += 1) {\n      for (let y = 0; y < height; y += 1) {\n        if (field[x]) {\n          this.drawPixel(x, y, field[x][y], states)\n        }\n      }\n    }\n\n    this.canvasContext.putImageData(this.canvasData, 0, 0)\n  }\n\n  refCanvas = (elem) => {\n    this.canvasContext = elem.getContext('2d')\n    this.canvasContext.fillStyle = '#000'\n    this.canvasContext.fillRect(0, 0, this.props.width, this.props.height)\n  }\n\n  canvasContext\n\n  canvasData\n\n  render () {\n    return (\n      <canvas\n        ref={this.refCanvas}\n        width={this.props.width}\n        height={this.props.height}\n      >\n        {'You are using an outdated browser without support of canvas elements.'}\n      </canvas>\n    )\n  }\n}\n","import React, { PureComponent } from 'react'\nimport PropTypes from 'prop-types'\nimport { Connector, Input } from 'state-control'\nimport { getRandomField, getUpdatedField } from '../utils'\nimport { DEFAULT, IDS, SPACE_CODE, STATUSES } from './constants'\nimport CanvasField from './CanvasField'\nimport style from './GriffeathMachine.css'\n\nexport default class GriffeathMachine extends PureComponent {\n  static propTypes = {\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    states: PropTypes.number.isRequired,\n  }\n\n  static defaultProps = { ...DEFAULT }\n\n  state = {\n    width: this.props.width,\n    height: this.props.height,\n    states: this.props.states,\n    status: STATUSES.pause,\n  }\n\n  field = null\n\n  canvas = React.createRef()\n\n  componentWillMount () {\n    this.randomizeField()\n    this.handlePlay()\n    document.addEventListener('keydown', this.processKey)\n  }\n\n  getActionName = () => (this.state.status === STATUSES.play ? STATUSES.pause : STATUSES.play)\n\n  randomizeField = () => {\n    this.field = getRandomField(this.state)\n  }\n\n  processKey = (e) => {\n    if (e.keyCode === SPACE_CODE) {\n      e.preventDefault()\n      this.handlePlay()\n    }\n  }\n\n  nextStep = () => {\n    try {\n      this.field = getUpdatedField({ ...this.state, field: this.field })\n    } catch (e) {\n      this.field = getRandomField(this.state)\n      this.setState({\n        status: STATUSES.pause,\n      })\n    }\n    this.canvas.current.paint(this.field)\n\n    if (this.state.status === STATUSES.play) {\n      requestAnimationFrame(this.nextStep)\n    }\n  }\n\n  handleNew = () => {\n    this.randomizeField()\n    this.canvas.current.paint(this.field)\n  }\n\n  handleNext = () => {\n    this.field = getUpdatedField({ ...this.state, field: this.field })\n    this.canvas.current.paint(this.field)\n  }\n\n  handlePlay = () => {\n    switch (this.state.status) {\n      case STATUSES.play:\n        this.setState({ status: STATUSES.pause })\n        break\n      case STATUSES.pause:\n        this.setState({ status: STATUSES.play }, this.nextStep)\n        break\n      default:\n    }\n  }\n\n  changeHandler = (name, value) => {\n    this.setState({ [name]: value })\n  }\n\n  selectAll = (control) => control.setSelectionRange(0, control.value.length)\n\n  render () {\n    return (\n      <div>\n        <Connector\n          state={this.state}\n          onChange={this.changeHandler}\n          onFocus={this.selectAll}\n        >\n          <Input\n            id={IDS.width}\n            label=\"Field width\"\n            defaultNum={1}\n          />\n          <Input\n            id={IDS.height}\n            label=\"Field height\"\n            defaultNum={1}\n          />\n          <Input\n            id={IDS.states}\n            label=\"Number of states\"\n            defaultNum={1}\n          />\n        </Connector>\n        <div\n          onClick={this.handlePlay}\n          onKeyDown={this.processKey}\n          className={style.field}\n          role=\"presentation\"\n          title={this.getActionName()}\n        >\n          <CanvasField\n            width={this.state.width}\n            height={this.state.height}\n            field={this.field}\n            states={this.state.states}\n            ref={this.canvas}\n          />\n        </div>\n        <p><em>Press Space or click field for play/pause</em></p>\n        <button type=\"button\" className={style.bigButton} onClick={this.handleNew}>\n          New\n        </button>\n        <button type=\"button\" className={style.bigButton} onClick={this.handlePlay}>\n          {this.getActionName()}\n        </button>\n        {this.state.status === STATUSES.pause && (\n          <button type=\"button\" className={style.bigButton} onClick={this.handleNext}>\n            Next step\n          </button>\n        )}\n        <p>\n          <small>\n            {'This experiment is made using '}\n            <a\n              href=\"https://www.npmjs.com/package/state-control\"\n              title=\"npm package\"\n            >\n              {'state-control'}\n            </a>\n            {'.'}\n          </small>\n        </p>\n      </div>\n    )\n  }\n}\n","import React from 'react'\nimport ErrorBoundary from './ErrorBoundary'\nimport GriffeathMachine from './GriffeathMachine'\n\nexport default () => <ErrorBoundary><GriffeathMachine /></ErrorBoundary>\n","import React from 'react'\nimport { render } from 'react-dom'\n\nimport './index.css'\nimport App from './components/App'\n\nrender(<App />, document.querySelector('#app'))\n\n// eslint-disable-next-line no-undef, comment: it's global\nconst stats = new Stats()\ndocument.body.appendChild(stats.dom)\nrequestAnimationFrame(function loop () {\n  stats.update()\n  requestAnimationFrame(loop)\n})\n"],"sourceRoot":""}